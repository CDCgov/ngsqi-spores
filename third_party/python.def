Bootstrap: docker
From: python:3.8.2-slim

%post
    # Update and install dependencies
    apt-get update && apt-get install -y procps && apt-get clean
    rm -rf /var/lib/apt/lists/*
    
    # Upgrade pip first
    pip install --upgrade pip
    
    # Install Biopython directly
    pip install biopython==1.81
    
    # Verify Biopython installation with full error output
    python -c "import sys; import Bio; print('Biopython path:', Bio.__file__); sys.exit(0)" || (echo "Bio module not found or not working"; exit 1)
    
    # Install other packages
    pip install matplotlib==3.4.3 numpy scipy pandas hclust2

# Set environment variables explicitly
%environment
    export LC_ALL=C
    export PYTHONPATH=/usr/local/lib/python3.8/site-packages:$PYTHONPATH

%runscript
    python "$@"

%test
    python -c "import Bio; from Bio import Entrez; print('Bio module version:', Bio.__version__)"